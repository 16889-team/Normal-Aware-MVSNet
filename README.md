# Normal-Aware-MVSNet

This repository contains the code of course project for CMU-16889 (advised by Shubham Tulsiani).

NA-MVSNet -- A Normal-Aware MVSNet with View-Consistency for Depth Estimation.

[Dijing Zhang*](https://github.com/dijingzhang)
[Chenhao Yang*](https://github.com/afiretony)

## Datasets

Datasets can be generated by data_io.py and we have preprocessed the low-resolution dataset from Eth3d (containing the image, depth and normal maps). You can download the [low-resolution datasets](https://drive.google.com/file/d/1NeWTiVFUkP1IaL9qxazTA1LVqk1w0_lC/view?usp=sharing) and [high-resolution datasets](https://cmu.box.com/s/mk4w3tspxrn49r2fzbr3x98pi3g2v60f)

### Normal Map Generation
Normal Map is genertaed by the idea from [this paper](https://ieeexplore.ieee.org/stamp/stamp.jsp?tp=&arnumber=7335535) and this normal is normalized to be unit.

## Train

Currently, we only test the low-resolution datasets and batch_size is set to be 16 due to the lack of computer resources.

```bash
python train.py --mode train/val --batch_size 16 --alpha 0.2 --beta 3 --gamma 0.2
```

You can see the training result in checkpoints/log.

## Acknowledgement
This project heavily relies codes from [MVSNet-pytorch](https://github.com/xy-guo/MVSNet_pytorch) and insipred by [NAS](https://github.com/udaykusupati/Normal-Assisted-Stereo) and we thank the authors for releasing their code.

We also thank Shubham Tulsiani for suggestions and guidance.
